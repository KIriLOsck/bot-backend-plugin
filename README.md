# Discord check plugin
Плагин позволяющий реализовать простую и удобную регистрацию пользователей на вашем сервере minecraft

### Requirements
- `git` и `docker-compose` для клонирования и запуска
- Minecraft сервер для установки плагина на версии `paper-1.20.1`
- Токен бота Discord и сервер на котором будет проходить регистрация
- `gradle` для кастомизации плагина "под себя" (опционально)

### Quick start
Чтобы настроить проверку и регистрацию

1. Клонируйте репозиторий в любую папку
```bash
git clone https://github.com/KIriLOsck/bot-backend-plugin.git
```
_или скачайте zip архив и распакуйте._

2. Перейдите в каталог проекта
```bash
cd bot-backend-plugin
```

3. Создайте файл окружения `.env` в каталоге `./disnake-bot` и вставьте туда нужные значения
```.env
BOT_TOKEN=ваш_токен_дискорд_бота
SERVER_ENDPOINT=http://backend-server:8000/
GUILDID=айди_сервера_discord
EVENT_MESSAGE_CHANNEL=айди_канала_регестрации
```
_если вы вручную разворачиваете сервисы поменяйте значение endpoint_
> Для обхода блокировки РКН установите и настройте xray или другой прокси и добавьте значения в `.env`

```.env
USE_PROXY=true
PROXY_URL=socks5://localhost:10808 # или адрес прокси на socks5
```
4. Запустите backend и бота одной командой
```bash
docker-compose up
# или docker compose up
```
> При запуске бот автоматически **отчистит** последние сообщения в указанном канале и оставит embed с кнопкой для регестрации игроков
5. Скачайте [последнюю версию плагина](https://github.com/KIriLOsck/bot-backend-plugin/releases) или соберите самостоятельно
```bash
cd minecraft-plugin
gradle build
```
6. Переместите файл плагина в папку `plugins` вашего сервера и запустите сервер.

***

После установки плагин будет обращаться к серверу чтобы убедиться что игрок зарегестрирован а затем отправлять код для входа в личные сообщения discord.

Если игрок не зарегестрирован он будет кикнут с соответствующим сообщением. 

Если сервер будет выключен то плагин не пропустит любых игроков на сервер, даже если они были зарегестрированы.

### Конфигурация
При желании можно настроить конфигурацию сообщений или системных параметров плагина в `plugins/NRFT/config.yml`
> Если вы запускаете сервер и backend на разных устройствах обязательно укажите ip backend в конфигурации